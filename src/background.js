chrome.runtime.onInstalled.addListener(() => {
  const bookmarksToAdd = [
    
    { title: "ðŸ’¡HEWP", url: "https://works.haryana.gov.in/HEWP_Login/login.aspx" },
    { title: "ðŸ‘¤Login", url: "javascript:(function(){const wait=ms=>new Promise(r=>setTimeout(r,ms));(async function(){document.getElementById('alogin')?.click();await wait(500);document.getElementById('contractorbtn')?.click();await wait(300);const captcha=document.getElementById('txtCaptcha');if(captcha){captcha.scrollIntoView({behavior:'smooth',block:'center'});captcha.focus();captcha.style.border='2px solid red';setTimeout(()=>captcha.style.border='',1500);}})();})();" },
    
    { title: "âž•AddBill", url: "javascript:(function(){const wait=ms=>new Promise(r=>setTimeout(r,ms));(async function(){document.getElementById('sidebarCollapse')?.click();await wait(300);document.querySelector('a.nav-link[href=\"#actmenucon\"]')?.click();await wait(300);const navLink=Array.from(document.querySelectorAll('a.nav-link')).find(a=>a.getAttribute('href')?.includes('Est_Add_Items_emb.aspx')&&a.textContent.trim().includes('Submit Bill to JE'));navLink?.click();})();})();" },
    { title: "ðŸ”Tender", url: "javascript:(function(){const%20existingInput=document.querySelector('%23independentTenderSearch%20input');if(existingInput){existingInput.scrollIntoView({behavior:'smooth',block:'center'});existingInput.focus();return;}const%20select=document.getElementById('ddltender');if(!select)return;select.scrollIntoView({behavior:'smooth',block:'center'});select.style.border='3px%20solid%20red';setTimeout(()=%3Eselect.style.border='',2000);const%20wrapper=document.createElement('div');wrapper.id='independentTenderSearch';Object.assign(wrapper.style,{position:'relative',marginBottom:'10px'});const%20input=document.createElement('input');input.type='text';input.placeholder='%F0%9F%94%8D%20Search%20tenders...';Object.assign(input.style,{width:'100%',padding:'6px',boxSizing:'border-box'});const%20list=document.createElement('div');Object.assign(list.style,{border:'1px%20solid%20%23ccc',maxHeight:'200px',overflowY:'auto',marginTop:'2px',background:'%23fff',position:'absolute',width:'100%',zIndex:'9999'});wrapper.appendChild(input);wrapper.appendChild(list);select.parentNode.insertBefore(wrapper,select);const%20allOptions=[...select.options].filter(opt=%3Eopt.value!=='Select%20One');let%20currentMatches=[];function%20escapeRegex(text){return%20text.replace(/[.*+?^${}()|[%5C%5D%5C%5C]/g,'%5C%24%26');}function%20render(matches){currentMatches=matches;list.innerHTML='';const%20searchText=input.value.trim().toLowerCase();matches.forEach(opt=%3E{const%20item=document.createElement('div');Object.assign(item.style,{padding:'5px%208px',cursor:'pointer',backgroundColor:'%23fff9c4',color:'%23000'});if(searchText.length%3E0){const%20regex=new%20RegExp(%60(${escapeRegex(searchText)})%60,'gi');item.innerHTML=opt.text.replace(regex,'%3Cspan%20style=%22color:%20red;%20font-weight:%20bold;%22%3E%241%3C/span%3E');}else{item.textContent=opt.text;}item.addEventListener('mouseover',()=%3E{item.style.backgroundColor='%231565c0';item.style.color='%23fff';});item.addEventListener('mouseout',()=%3E{item.style.backgroundColor='%23fff9c4';item.style.color='%23000';});item.addEventListener('mousedown',()=%3E{selectOption(opt);});list.appendChild(item);});}function%20selectOption(opt){select.value=opt.value;const%20event=new%20Event('change',{bubbles:true,cancelable:true});select.dispatchEvent(event);if(typeof%20select.onchange==='function')%20select.onchange();else%20if(typeof%20__doPostBack==='function')%20__doPostBack('_ctl0%24maincontentcm%24ddltender','');list.innerHTML='';input.value='';}input.addEventListener('keydown',(e)=%3E{if(e.key==='Enter'%26%26currentMatches.length%3E0){e.preventDefault();selectOption(currentMatches[0]);}});input.addEventListener('input',()=%3E{const%20val=input.value.toLowerCase();const%20matches=allOptions.filter(opt=%3Eopt.text.toLowerCase().includes(val));render(matches);});input.addEventListener('focus',()=%3Erender(allOptions));input.addEventListener('blur',()=%3EsetTimeout(()=%3E{list.innerHTML='';},200));input.focus();input.scrollIntoView({behavior:'smooth',block:'center'});})();" },

    { title: "ðŸŽ¯Item", url: "javascript:(function(){const%20e=document.querySelector('%23independentItemSearch%20input');if(e)return%20e.focus(),void%20e.scrollIntoView({behavior:'smooth',block:'center'});const%20t=document.querySelector('%23ddlitemnumber');if(!t)return;t.scrollIntoView({behavior:'smooth',block:'center'}),t.style.border='3px%20solid%20red',setTimeout(()=%3Et.style.border='',2000);const%20n=document.createElement('div');n.id='independentItemSearch',n.style.position='relative',n.style.marginBottom='10px';const%20o=document.createElement('input');o.type='text',o.placeholder='%F0%9F%94%8D%20Search%20items...',o.style.width='100%25',o.style.padding='6px',o.style.boxSizing='border-box';const%20l=document.createElement('div');l.style.border='1px%20solid%20%23ccc',l.style.maxHeight='200px',l.style.overflowY='auto',l.style.marginTop='2px',l.style.background='%23fff',l.style.position='absolute',l.style.width='100%25',l.style.zIndex='9999',n.appendChild(o),n.appendChild(l),t.parentNode.insertBefore(n,t);const%20i=[...t.options].filter(e=%3E'Select%20One'!==e.value);let%20r=[];function%20a(e){r=e,l.innerHTML='',e.forEach(e=%3E{const%20n=document.createElement('div');n.style.padding='5px%208px',n.style.cursor='pointer',n.style.background='%23fff9c4',n.style.color='%23000';const%20i=o.value.trim().toLowerCase();if(i.length%3E0){const%20r=i.replace(/[.*+?^${}()|[%5C%5D%5C%5C]/g,'%5C%5C%24%26'),c=new%20RegExp(%60(${r})%60,'gi');n.innerHTML=e.text.replace(c,'%3Cspan%20style=%22color:%20red;%20font-weight:%20bold;%22%3E%241%3C/span%3E')}else%20n.textContent=e.text;n.onmouseover=()=%3E{n.style.background='%231565c0',n.style.color='%23fff'},n.onmouseout=()=%3E{n.style.background='%23fff9c4',n.style.color='%23000'},n.onmousedown=function(){d(e)},l.appendChild(n)})}function%20d(e){t.value=e.value,t.dispatchEvent(new%20Event('change')),l.innerHTML='',o.value=''}o.addEventListener('keydown',e=%3E{'Enter'===e.key%26%26r.length%3E0%26%26(e.preventDefault(),d(r[0]))}),o.addEventListener('input',function(){const%20e=this.value.toLowerCase(),n=i.filter(t=%3Et.text.toLowerCase().includes(e));a(n)}),o.addEventListener('focus',()=%3Ea(i)),o.addEventListener('blur',()=%3EsetTimeout(()=%3El.innerHTML='',200)),setTimeout(()=%3E{o.focus(),o.scrollIntoView({behavior:'smooth',block:'center'})},500)})();" }, 

    { title: "ðŸ†•Entries", url: "javascript:(function(){ const r = document.getElementById('rblitemshsr_1'); if (r) { r.click(); r.scrollIntoView({behavior: 'smooth', block: 'start'}); }})();" },

    { title: "ðŸ“ChooseExcel", url: "javascript:(function(){const wait=ms=>new Promise(r=>setTimeout(r,ms));(async function(){document.querySelector('button[data-bs-target=\"#MyPopup\"]')?.click();await wait(200);document.getElementById('FileUploadexcel')?.click();})();})();" },
    { title: "ðŸ”¼Upload", url: "javascript:(function(){document.getElementById(\"btn_excel\")?.click();})();" },
    { title: "âœ…CopyExcel Data", url: "javascript:(function(){ document.getElementById('btncopyexcel')?.click();})();" },
    { title: "âœ…DONE", url: "javascript:(function(){ const wait = ms => new Promise(r => setTimeout(r, ms)); (async function(){ const okBtn = document.querySelector('button.confirm'); if (okBtn && okBtn.textContent.trim().toLowerCase() === 'ok') okBtn.click(); await wait(500); document.querySelector('button[data-bs-dismiss=\"modal\"]')?.click(); await wait(500); const r = document.getElementById('rblitemshsr_1'); if (r) { r.click(); r.scrollIntoView({behavior: 'smooth', block: 'start'}); } })();})();" },
    { title: "ðŸ“¤Anex", url: "javascript:(function(){var fileInput=document.getElementById('FileUpload3');if(fileInput){fileInput.click();}else{alert('File input not found.');}})();" },
    { title: "ðŸš€Manual add", url: "javascript:(function(){var btn=document.getElementById('btn_add_Description');if(btn){btn.click();}else{alert('Button not found.');}})();" },
    { title: "âš–ï¸MaxQTY", url: "javascript:(()=>{const v=document.getElementById('lbltobeexecuted'),u=document.getElementById('lbltobeexecutedunit');if(!v||!u)return alert('Contact @mrgargsir.');const dn=parseFloat(v.textContent);if(isNaN(dn))return alert('Value is not a number.');const unit=u.textContent.trim(),al=(dn*0.25).toFixed(2),total=(dn*1.25).toFixed(2),msg=`âš–ï¸ DNIT QTY       = ${dn} ${unit}\nâž• ALLOWANCE 25%  = ${al} ${unit}\nâœ… TOTAL          = ${total} ${unit}`;try{alert(msg)}catch{if(Notification.permission==='granted')new Notification(msg);else if(Notification.permission!=='denied')Notification.requestPermission().then(p=>p==='granted'?new Notification(msg):alert(msg));else alert(msg)}})();" },
    { title: "MRGARGSIR", url: "https://github.com/mrgargsir" },
    
  ];

  
 
 chrome.bookmarks.getChildren("1", (existingBookmarks) => {
    const titlesToRemove = bookmarksToAdd.map(b => b.title);

    // Remove existing bookmarks with same titles
    existingBookmarks.forEach(b => {
      if (titlesToRemove.includes(b.title)) {
        chrome.bookmarks.remove(b.id);
      }
    });

    // Add new bookmarks
    bookmarksToAdd.forEach(bookmark => {
      chrome.bookmarks.create({
        parentId: "1",
        title: bookmark.title,
        url: bookmark.url
      });
    });
  });
});
